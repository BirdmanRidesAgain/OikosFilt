manifest {
    author = 'Keiler Collier'
    description = 'A NextFlow-enabled pipeline intended to streamline SNP discovery from .vcf files'
    mainScript = 'main.nf'
    name = 'OikosFilt'
    nextflowVersion = '>=25.0.0' //this is the version of NextFlow I initially developed the pipeline on. It might work for others.
    version = '1.0.0'
}

// Params for upper-resource limits:
    max_cpus = Runtime.runtime.availableProcessors()
    totalMemoryGB = Runtime.runtime.maxMemory() / 1024 / 1024 / 1024 
    memoryToUseGB = (totalMemoryGB * 0.8).round(2)

// Params for output
workflow.output.mode = 'copy'



 params {
// Params for upper-resource limits:
    max_cpus = Runtime.runtime.availableProcessors()
    totalMemoryGB = Runtime.runtime.maxMemory() / 1024 / 1024 / 1024 
    memoryToUseGB = (totalMemoryGB * 0.8).round(2)

//input params
    help = false
    vcf = null
    bi_snps = true
    dp_95ile = true
    min_dp = 10
    min_qual = 20
    min_gq = 20
    threads = max_cpus / 2
    prefix = 'out'
}

process {
    resourceLimits = [ cpus: params.max_cpus, memory: params.memoryToUseGB, time: 72.h ]
}


/*
 * defines execution profiles for different environments
 */
 profiles {
    standard {
        conda.enabled = true
        conda.channels = ['bioconda', 'conda-forge']
        report.overwrite = true
    }
    mamba {
        conda.enabled = true
        conda.useMicromamba = true
        conda.channels = ['conda-forge,bioconda']
    }

}
